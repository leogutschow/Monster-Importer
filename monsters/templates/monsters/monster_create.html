{% extends 'base.html' %}
{% load static %}
<head xmlns="http://www.w3.org/1999/html">
    <title>{% block 'titulo' %}Create Monster{% endblock %}</title>
    {% block 'styles' %}
    <style>
        .hidden {
            display: none;
        }
    </style>
    {% endblock %}
</head>
<body>
    {% block 'conteudo' %}
        <div class="container text-center p-5">
            <form class="container" method="POST" action="#create_monster" enctype="multipart/form-data"
            style="background-image: url(https://i.imgur.com/hTt73aH.png); max-width: 40vw; max-height:7000px">
                {% csrf_token %}
                <div class="form-group row">
                    <div id="baseSheetForm" class="col">
                        <div class="container row pt-2 game-selector">
                            <label class="form-label" for="id_game">Game</label>
                            {{ form.game }}
                        </div>
                        ________________________________________________________________________________________________
                        <div class="container row pt-2">
                            <label class="form-label" for="id_name">Monster Name</label>
                            {{ form.name }}
                            <div class="col m-0">
                                <label class="form-label" for="id_size">Size</label>
                                {{ form.size }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_race">Race</label>
                                {{ form.race }}
                            </div>
                        </div>
                        <div class="container row pt-2">
                            <div class="col m-0">
                                <label class="form-label" for="id_ac">Armor</label>
                                {{ form.ac }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_ac_type">Armor Class</label>
                                {{ form.ac_type }}
                            </div>
                        </div>
                         <div class="container row pt-2">
                            <div class="col m-0">
                                <label class="form-label" for="id_hp">Hit Points</label>
                                {{ form.hp }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_hp_dices">Hit Points Dices</label>
                                {{ form.hp_dices }}
                            </div>
                             <div class="col m-0">
                                <label class="form-label" for="id_movement">Speed</label>
                                {{ form.movement }}
                            </div>
                        </div>
                        <div class="container row pt-2">
                            <div class="col m-0">
                                <label class="form-label" for="id_strength">STR</label>
                                {{ form.strength }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_dexterity">DEX</label>
                                {{ form.dexterity }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_constitution">CON</label>
                                {{ form.constitution }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_intelligence">INT</label>
                                {{ form.intelligence }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_wisdom">WIS</label>
                                {{ form.wisdom }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_charisma">CHA</label>
                                {{ form.charisma }}
                            </div>
                        </div>
                        <div class="container row pt-2">
                            <div class="col m-0">
                                <label class="form-label" for="id_languages">Languages</label>
                                {{ form.languages }}
                            </div>
                        </div>
                    </div>
                    ________________________________________________________________________________________________
                    <div id="dndMonsterForm" class="container col">
                        <div class="container row pt-2">
                            <div class="col">
                                <label class="form-label" for="id_alignment">Alignment</label>
                                {{ dndmonster.alignment }}
                            </div>
                            <div class="col">
                                <label class="form-label" for="id_challenge">Challenge</label>
                                {{ dndmonster.challenge }}
                            </div>
                        </div>
                        <div class="container row pt-2">
                            <div class="col m-0">
                                <label class="form-label" for="id_description">Monster Description</label>
                                {{ dndmonster.description }}
                            </div>
                        </div>
                        <div class="container row pt-2">
                            <div class="col m-0">
                                <label class="form-label" for="id_image">Image</label>
                                {{ dndmonster.image }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_senses">Senses</label>
                                {{ dndmonster.senses }}
                            </div>
                        </div>
                        <div class="container row pt-2">
                            <div class="col m-0">
                                <label class="form-label" for="id_damage_resistances">Damage Resistances</label>
                                {{ dndmonster.damage_resistances }}
                            </div>
                            <div class="col m-0">
                                <label class="form-label" for="id_damage_immunities">Damage Immunities</label>
                                {{ dndmonster.damage_immunities }}
                            </div>
                        </div>
                        <div class="container row pt-2">
                            <div class="col m-0">
                                <label  class="form-label"for="id_condition_immunities">Condition Immunities</label>
                                {{ dndmonster.condition_immunities }}
                            </div>
                        </div>
                    </div>
                        ________________________________________________________________________________________________
                    <div id="dndTraitForm">
                        <h5>Traits</h5>
                        {{ dndtrait.management_form }}
                        <div id="traitList">
                            {% for trait in dndtrait %}
                                <div class="trait-form">
                                    {{ trait }}
                                </div>
                            {% endfor %}
                        </div>
                        <button id="addTraitBtn" class="btn btn-success" type="button">Add Trait</button>
                    </div>
                        ________________________________________________________________________________________________
                    <div id="dndActionForm">
                        <h5>Actions</h5>
                        {{ dndaction.management_form }}
                        <div id="formList">
                            {% for action in dndaction %}
                            <div class="action-form">
                                {{ action }}
                                <br></br>
                            </div>
                            {% endfor %}
                        </div>
                        <button id="addActionBtn" type="button">Add an Action</button>
                    </div>
                </div>

                <button type="submit">Submit</button>
            </form>
            <div id="emptyActionForm" class="hidden">{{ dndaction.empty_form }}</div>
            <div id="emptyTraitForm" class="hidden">
                <div class="p-2">
                    <label class="form-label" for="{{ dndtrait.empty_form.specialtrait_name.id_for_label }}">Trait Name</label>
                    {{ dndtrait.empty_form.specialtrait_name }}
                    <label class="form-label" for="{{ dndtrait.empty_form.specialtrait_description.id_for_label }}">Trait Description</label>
                    {{ dndtrait.empty_form.specialtrait_description }}
                    <div class="row">
                        <div class="col">
                            <label class="form-label" for="{{ dndtrait.empty_form.spellcasting.id_for_label }}">Is Spellcaster:</label>
                            {{ dndtrait.empty_form.spellcasting }}
                        </div>
                        <div class="col">
                            <label class="form-label" for="{{ dndtrait.empty_form.spellcasting.id_for_label }}">Spells:</label>
                            {{ dndtrait.empty_form.dnd_spells }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% verbatim %}
        <script>
            const totalActionNewForms = document.getElementById('id_dndaction_set-TOTAL_FORMS')
            const totalTraitNewForms = document.getElementById('id_dndspecialtraits_set-TOTAL_FORMS')
            const addActionBtn = document.getElementById('addActionBtn')
            addActionBtn.addEventListener('click', add_new_action)
            const addTraitBtn = document.getElementById('addTraitBtn')
            addTraitBtn.addEventListener('click', add_new_trait)

            function add_new_action(event) {
                if (event){
                    event.preventDefault()
                }
                const currentActionsForms = document.getElementsByClassName('action-form')
                const formCopyTarget = document.getElementById('formList')
                const emptyForm = document.getElementById('emptyActionForm').cloneNode(true)
                emptyForm.setAttribute('class', 'action-form')
                emptyForm.setAttribute('id', `form-${currentActionsForms.length +1}`)
                const regex = new RegExp('__prefix__', 'g')
                emptyForm.innerHTML = emptyForm.innerHTML.replace(regex, currentActionsForms.length)
                totalActionNewForms.setAttribute('value', currentActionsForms.length + 1)
                formCopyTarget.append(emptyForm)
            }

            function add_new_trait(event){
                if (event){
                    event.preventDefault()
                }
                const currentTraitForms = document.getElementsByClassName('trait-form')
                const formCopyTarget = document.getElementById('traitList')
                const emptyForm = document.getElementById('emptyTraitForm').cloneNode(true)
                emptyForm.setAttribute('class', 'trait-form')
                emptyForm.setAttribute('id', `form-${currentTraitForms.length +1}`)
                const regex = new RegExp('__prefix__', 'g')
                emptyForm.innerHTML = emptyForm.innerHTML.replace(regex, currentTraitForms.length)
                totalTraitNewForms.setAttribute('value', currentTraitForms.length + 1)
                formCopyTarget.append(emptyForm)
            }
        </script>
    {% endverbatim %}

    {% endblock %}
</body>
</html>